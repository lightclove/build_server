. Клиент отправляет запрос, состоящий из трех полей: имя файла, номер начального байта (смещение) и количество байтов для передачи. Имя файла - это имя файла, который клиент хочет загрузить. Начальный номер (байты) - это номер байта в файле, с которого клиент хочет начать загрузку (т.е. начальный байт фрагмента). Количество байтов для передачи - это общее количество байтов, которое клиент хочет загрузить после смещения номера начального байта. Когда поток на стороне сервера получает сообщение, он отправляет запрошенную часть файла и завершает передачу файла.

Если ответ (размер файла) положительный, он делит полученный размер файла на k, чтобы определить смещение и количество байтов, которое необходимо получить для каждого фрагмента. Клиент немедленно создает k сокетов TCP (каждый для чанка) и использует функцию «select (...)» для асинхронного ввода-вывода. То есть клиент загружает порции параллельно и использует мультиплексирование ввода-вывода вместо многопоточности. Когда все чанки получены, они просто объединяют чанки в один файл.


CLIENT PART:

The client is single-threaded. Whenever it needs to download a file from a server first, it sends a UDP look-up message. If the response (file size) is positive it divides the obtained file size with k in order to determine the offset and the number of bytes needs to be received for each chunk. The client immediately creates k TCP sockets (each for a chunk) and uses "select(...)" function for asynchronous IO. That is, the client downloads the chunks in parallel and uses IO multiplexing instead of multi-threading. When all chunks are received it simply merges the chunks into a single file

Сервер в основном предоставляет две разные службы (i) службу поиска файлов (ii) службу передачи файлов. Служба поиска файлов - это служба UDP. Клиенты отправляют UDP-пакеты, содержащие имя файла. Когда сервер получает сообщение, он проверяет список файлов, которые он размещает, и отправляет размер файла (в байтах), если он размещает файл, в противном случае отправляет ноль. Служба передачи файлов - это многопоточная служба TCP. Клиенты сначала инициализируют TCP-соединение с сервером перед отправкой запроса на передачу файла. Каждый раз, когда создается соединение TCP, сервер инициализирует новый поток (или, возможно, использует свободный поток в пуле потоков) и передает оставшуюся часть связи в новый поток. Клиент отправляет запрос, состоящий из трех полей: имя файла, номер начального байта (смещение) и количество байтов для передачи. Имя файла - это имя файла, который клиент хочет загрузить. Начальный номер (байты) - это номер байта в файле, с которого клиент хочет начать загрузку (т.е. начальный байт фрагмента). Количество байтов для передачи - это общее количество байтов, которое клиент хочет загрузить после смещения номера начального байта. Когда поток на стороне сервера получает сообщение, он отправляет запрошенную часть файла и завершает передачу файла.

1] получить фактический размер файла
2] добавьте нужный файл к нужному размеру
3] Позже отправить фактический размер файла.

1] Receive the file completely which is padded.
2] Receive actual file size.
3] unpad the padded bytes to get actual file.
